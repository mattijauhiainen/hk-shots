var C=o=>{throw TypeError(o)};var V=(o,t,i)=>t.has(o)||C("Cannot "+i);var e=(o,t,i)=>(V(o,t,"read from private field"),i?i.call(o):t.get(o)),n=(o,t,i)=>t.has(o)?C("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(o):t.set(o,i),d=(o,t,i,a)=>(V(o,t,"write to private field"),a?a.call(o,i):t.set(o,i),i),k=(o,t,i)=>(V(o,t,"access private method"),i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function i(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(s){if(s.ep)return;s.ep=!0;const r=i(s);fetch(s.href,r)}})();function O(o){return`${o.replace(".avif","_800.avif")} 800w,
${o.replace(".avif","_1200.avif")} 1200w,
${o.replace(".avif","_1500.avif")} 1500w,
${o.replace(".avif","_1800.avif")} 1800w,
${o} 2000w`}var p,x,L,S;class R{constructor(){n(this,p,new Date);n(this,x,[]);n(this,L,[]);n(this,S,[]);window.addEventListener("popstate",t=>{const i=location.hash.slice(1);t.state.valueOf()-e(this,p).valueOf()>0?e(this,L).forEach(s=>s(i,{hasUAVisualTransition:t.hasUAVisualTransition})):e(this,x).forEach(s=>s(i,{hasUAVisualTransition:t.hasUAVisualTransition})),d(this,p,history.state)})}registerBackCallback(t){e(this,x).push(t)}registerForwardCallback(t){e(this,L).push(t)}registerOnPushCallback(t){e(this,S).push(t)}push(t){d(this,p,new Date),history.pushState(e(this,p),"","#"+t),e(this,S).forEach(i=>i(t))}}p=new WeakMap,x=new WeakMap,L=new WeakMap,S=new WeakMap;const y=new R;var f,l,b,h,P,q,N;class M{constructor(t){n(this,P);n(this,f);n(this,l);n(this,b);n(this,h);d(this,f,t),d(this,l,t.querySelector("img")),d(this,b,t.querySelector("figcaption")),e(this,f).addEventListener("click",()=>this.closeFullImage()),e(this,f).addEventListener("keydown",k(this,P,N).bind(this))}set photo(t){if(d(this,h,t),e(this,h)===void 0){e(this,l).src="",e(this,l).alt="",e(this,l).style.aspectRatio="",e(this,b).textContent="";return}e(this,l).style.aspectRatio=e(this,h).aspectRatio,e(this,l).src=e(this,h).fullSizeImagePath,e(this,l).srcset=O(e(this,h).fullSizeImagePath),e(this,l).alt=e(this,h).altAttribute,e(this,b).textContent=e(this,h).altAttribute+" 2024 Matti Jauhiainen. All rights reserved.",k(this,P,q).call(this)}get filename(){var t;return(t=e(this,h))==null?void 0:t.filename}get isVisible(){return!!e(this,h)}showModal(){const t=window.scrollY;document.body.style.position="fixed",document.body.style.top=`-${t}px`,document.body.style.left="0px",document.body.style.right="0px",e(this,f).showModal()}closeFullImage({skipTransition:t=!1}={}){const i=()=>{const s=document.body.style.top;y.push(""),document.body.style.position="",document.body.style.top="",document.body.style.left="",document.body.style.right="",e(this,f).close(),t||(e(this,h).viewTransitionName="photo"),window.scrollTo(0,parseInt(s||"0")*-1)};(t||!document.startViewTransition)&&(i(),this.photo=void 0),document.startViewTransition({update:i,types:["shrink"]}).finished.finally(()=>{e(this,h).viewTransitionName="",this.photo=void 0})}}f=new WeakMap,l=new WeakMap,b=new WeakMap,h=new WeakMap,P=new WeakSet,q=function(){e(this,l).classList.remove("horizontal"),e(this,l).classList.remove("vertical"),e(this,h).isVertical?e(this,l).classList.add("vertical"):e(this,l).classList.add("horizontal")},N=function(t){t.key==="Escape"&&(t.preventDefault(),t.stopPropagation(),this.closeFullImage())};var v,g,E,z;class U{constructor(t,i){n(this,E);n(this,v);n(this,g);d(this,v,t),d(this,g,i),document.addEventListener("keydown",a=>{a.key==="ArrowLeft"&&e(this,g).isVisible&&(a.preventDefault(),a.stopPropagation(),k(this,E,z).call(this))})}}v=new WeakMap,g=new WeakMap,E=new WeakSet,z=function(){const t=e(this,v).findIndex(s=>s.filename===e(this,g).filename);if(t<=0)return;const i=e(this,v)[t-1];y.push(i.filename);const a=()=>{e(this,g).photo=i};if(!document.startViewTransition){a();return}document.startViewTransition({update:a,types:["backward"]})};var w,m,F,D;class B{constructor(t,i){n(this,F);n(this,w);n(this,m);d(this,w,t),d(this,m,i),document.addEventListener("keydown",a=>{a.key==="ArrowRight"&&e(this,m).isVisible&&(a.preventDefault(),a.stopPropagation(),k(this,F,D).call(this))})}}w=new WeakMap,m=new WeakMap,F=new WeakSet,D=function(){const t=e(this,w).findIndex(s=>s.filename===e(this,m).filename);if(t===e(this,w).length-1)return;const i=e(this,w)[t+1];y.push(i.filename);const a=()=>{e(this,m).photo=i};if(!document.startViewTransition){a();return}document.startViewTransition({update:()=>{e(this,m).photo=i},types:["forward"]})};var u,I,T;class _{constructor(t,i){n(this,u);n(this,I);n(this,T);d(this,u,t),d(this,T,i),d(this,I,t.querySelector("img")),e(this,u).addEventListener("mouseover",this.preloadFullImage.bind(this)),e(this,u).addEventListener("click",a=>{a.preventDefault(),a.stopPropagation(),this.displayFullImage(),y.push(this.filename)})}get filename(){return e(this,u).getAttribute("data-filename")}get fullSizeImagePath(){return`images/${this.filename}`}get altAttribute(){return e(this,I).getAttribute("alt")}get isVertical(){return e(this,u).getAttribute("data-is-vertical")==="true"}get width(){const t=parseInt(e(this,u).getAttribute("data-width")??"");if(!(t>0))throw new Error("Invalid width");return t}get height(){const t=parseInt(e(this,u).getAttribute("data-height")??"");if(!(t>0))throw new Error("Invalid height");return t}get aspectRatio(){return`${this.width} / ${this.height}`}set viewTransitionName(t){e(this,I).style.viewTransitionName=t}hasBeenPreloaded(){const t=`${window.origin}${this.fullSizeImagePath}`;return document.querySelectorAll(`link[rel="preload"][href="${t}"]`).length>0}preloadFullImage(){if(this.hasBeenPreloaded())return;const t=`${window.origin}${this.fullSizeImagePath}`;if(document.querySelectorAll(`link[rel="preload"][href="${t}"]`).length>0)return;const i=document.createElement("link");i.rel="preload",i.as="image",i.href=t,i.imageSizes="(min-width: 1800px) 1800px, 100vw",i.imageSrcset=O(this.fullSizeImagePath),document.head.appendChild(i)}displayFullImage({transitionType:t="expand",skipTransition:i=!1}={}){i||(this.viewTransitionName="photo");const a=()=>{e(this,T).photo=this,e(this,T).showModal()};return i||!document.startViewTransition?(a(),Promise.resolve()):document.startViewTransition({update:a,types:[t]}).finished.then(()=>{this.viewTransitionName=""})}}u=new WeakMap,I=new WeakMap,T=new WeakMap;document.addEventListener("DOMContentLoaded",async()=>{const o=new M(document.querySelector("#expanded-photo-container")),t=Array.from(document.querySelectorAll(".photo-grid a")).map(a=>new _(a,o));new B(t,o),new U(t,o);const i=Y(t,window.location.hash);i?i.displayFullImage({transitionType:"reload"}).finally(()=>{document.querySelector("main").style.visibility="visible"}):document.querySelector("main").style.visibility="visible",y.registerBackCallback((a,{hasUAVisualTransition:s})=>{const r=t.find(c=>c.filename===a);r?r.displayFullImage({transitionType:"backward",skipTransition:s}):o.closeFullImage({skipTransition:s})}),y.registerForwardCallback((a,{hasUAVisualTransition:s})=>{const r=t.find(c=>c.filename===a);r?r.displayFullImage({transitionType:"forward",skipTransition:s}):o.closeFullImage({skipTransition:s})}),y.registerOnPushCallback(a=>{var r,c;const s=t.findIndex(A=>A.filename===a);s!==-1&&(t[s].hasBeenPreloaded()?((r=t[s+1])==null||r.preloadFullImage(),(c=t[s-1])==null||c.preloadFullImage()):setTimeout(()=>{var A,$;(A=t[s+1])==null||A.preloadFullImage(),($=t[s-1])==null||$.preloadFullImage()},300))})});function Y(o,t){const i=t.slice(1);return o.find(a=>a.filename===i)}
